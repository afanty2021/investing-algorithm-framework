# 贡献指南

<cite>
**本文档中引用的文件**  
- [README.md](file://README.md)
- [docs/ISSUE_TEMPLATE/bug_report.md](file://docs/ISSUE_TEMPLATE/bug_report.md)
- [docs/ISSUE_TEMPLATE/feature_request.md](file://docs/ISSUE_TEMPLATE/feature_request.md)
- [docs/PULL_REQUEST_TEMPLATE.md](file://docs/PULL_REQUEST_TEMPLATE.md)
- [.flake8](file://.flake8)
- [pyproject.toml](file://pyproject.toml)
- [tests/test_create_app.py](file://tests/test_create_app.py)
- [tests/app/test_app_initialize.py](file://tests/app/test_app_initialize.py)
</cite>

## 目录
1. [简介](#简介)
2. [报告问题](#报告问题)
3. [提交拉取请求](#提交拉取请求)
4. [测试策略与CI/CD](#测试策略与CI/CD)
5. [代码审查标准](#代码审查标准)
6. [社区参与](#社区参与)

## 简介

投资算法框架是一个社区驱动的项目，旨在为量化交易策略的开发、回测和部署提供一个高效、可扩展的解决方案。本贡献指南旨在为开发者提供清晰的指导，帮助他们参与项目开发，包括如何报告问题、提交拉取请求、遵循测试策略以及参与社区讨论。

本项目欢迎各种形式的贡献，无论是发现并报告bug、提出新功能建议，还是直接参与代码开发。我们相信，通过社区的共同努力，可以不断改进和完善这个框架，使其更好地服务于量化交易开发者。

**Section sources**
- [README.md](file://README.md#L450-L457)

## 报告问题

当您在使用投资算法框架时遇到问题，可以通过GitHub的issue跟踪系统报告。我们提供了两种预定义的模板来帮助您清晰地描述问题：一种用于报告bug，另一种用于提出功能请求。

### Bug报告

如果您发现了框架中的一个bug，请使用bug报告模板。在报告中，请提供以下信息：

- **问题描述**：清晰、简洁地描述您遇到的bug。
- **复现步骤**：列出复现该行为的步骤。
- **预期行为**：描述您期望发生的行为。
- **环境信息**：包括操作系统、Python版本和包版本。

**Section sources**
- [docs/ISSUE_TEMPLATE/bug_report.md](file://docs/ISSUE_TEMPLATE/bug_report.md)

### 功能请求

如果您希望框架增加新功能或改进现有功能，请使用功能请求模板。在请求中，请提供以下信息：

- **问题关联**：说明您的功能请求是否与某个具体问题相关。
- **期望的解决方案**：描述您希望该功能如何工作。
- **考虑的替代方案**：列出您考虑过的其他解决方案或功能。

**Section sources**
- [docs/ISSUE_TEMPLATE/feature_request.md](file://docs/ISSUE_TEMPLATE/feature_request.md)

## 提交拉取请求

提交拉取请求（Pull Request）是向项目贡献代码的主要方式。为了确保代码质量和一致性，请遵循以下规范。

### 代码风格

项目使用`flake8`进行代码风格检查。请确保您的代码符合PEP 8规范。您可以在本地运行`flake8`来检查代码风格。

```ini
[flake8]
exclude =
    investing_algorithm_framework/app/reporting/
    investing_algorithm_framework/infrastructure/database/sql_alchemy.py
    examples
    investing_algorithm_framework/services/metrics
```

**Section sources**
- [.flake8](file://.flake8)

### 测试要求

所有新功能和bug修复都必须包含相应的测试。项目使用`unittest`框架进行测试。在提交拉取请求之前，请确保所有测试都能通过。

```bash
# 运行所有测试
python -m unittest discover -s tests

# 运行特定测试
python -m unittest tests.services.test_trade_service.TestTradeService
```

**Section sources**
- [README.md](file://README.md#L424-L432)
- [tests/test_create_app.py](file://tests/test_create_app.py)
- [tests/app/test_app_initialize.py](file://tests/app/test_app_initialize.py)

### 文档更新

如果您的更改影响了公共API或用户界面，请确保更新相应的文档。这包括README文件、API文档和任何相关的示例代码。

## 测试策略与CI/CD

项目采用持续集成（CI）和持续部署（CD）流程来确保代码质量和稳定性。每次提交到`develop`分支都会触发GitHub Actions工作流，运行测试套件。

### 测试策略

项目使用`coverage`工具来测量代码覆盖率。目标是保持高代码覆盖率，确保大部分代码都经过测试。测试分为单元测试和集成测试，覆盖核心功能、服务和API。

```toml
[tool.poetry.group.test.dependencies]
coverage= "7.4.2"
flake8 = "7.0.0"
Flask-Testing = "^0.8.1"
pyindicators = "0.11.1"
```

**Section sources**
- [pyproject.toml](file://pyproject.toml#L36-L41)
- [poetry.lock](file://poetry.lock#L1005-L1067)

### CI/CD流程

CI/CD流程包括以下步骤：
1. 代码风格检查
2. 运行测试套件
3. 测量代码覆盖率
4. 构建和发布包到PyPI

这些步骤在GitHub Actions中自动化执行，确保每次提交都经过严格的验证。

## 代码审查标准

所有拉取请求都需要经过代码审查。审查标准包括：
- 代码是否符合项目风格指南
- 是否有足够的测试覆盖
- 文档是否更新
- 代码是否易于理解和维护
- 是否解决了报告的问题或实现了请求的功能

审查过程是协作的，我们鼓励建设性的反馈和讨论，以提高代码质量。

## 社区参与

我们鼓励社区成员积极参与项目的讨论和发展。您可以通过以下方式参与：
- 在GitHub上报告问题或提出功能请求
- 参与Discord社区的实时聊天和讨论
- 在Reddit社区分享策略和讨论
- 贡献代码和文档

社区的参与是项目成功的关键。我们欢迎您加入我们，共同构建更好的量化交易工具。

**Section sources**
- [README.md](file://README.md#L471-L478)